webpackJsonp([48],{"+0ly":function(t,e,a){"use strict";var l=a("HzJ8"),s=a.n(l);e.a={data:function(){return{title:"新建预审模板",fileList:[],logo_visible:!1,template_from:{productID:"",templateName:"",apk:"",logo:"",picUrls:[],id:"",type:"1"},templateDisable:!1,saveAlt:{status:!1,date:""},options:{product:[{id:"1",val:"nihao"}]},but_text:"确认",status:{product:!1,template:!1}}},created:function(){this.pageInfo()},methods:{pageInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.getListUrl,params:{type:"3"}}).then(function(e){var a=e.data;1==a.status?t.options.product=a.list:console.log(a.msg)}).catch(function(t){console.log(t)}),""!=this.$route.query.templateId&&(this.template_from.id=decodeURIComponent(this.$route.query.templateId),this.templateDisable=this.logo_visible=this.status.product=this.status.template=!0,this.title="编辑预审模板",this.but_text="保存",this.$http({method:"get",url:this.apiUrl.templateGetUrl,params:{id:this.template_from.id}}).then(function(e){if(200==e.status){t.template_from=e.data,t.template_from.productID=parseInt(t.template_from.productID),t.template_from.picUrls=t.picSort(t.template_from.picUrls,"@#@");var a=[],l=!0,o=!1,r=void 0;try{for(var i,p=s()(t.template_from.picUrls);!(l=(i=p.next()).done);l=!0){var n=i.value;a.push({name:t.picSubName(n),url:n})}}catch(t){o=!0,r=t}finally{try{!l&&p.return&&p.return()}finally{if(o)throw r}}t.fileList=a}}).catch(function(t){console.log(t)}))},onSubmit:function(){var t=this;if(this.template_from.picUrls.length>0){this.template_from.picUrls=this.pic_sort(this.template_from.picUrls);var e="";e="保存"==this.but_text?this.apiUrl.templateUpdateUrl:this.apiUrl.templateNewUrl,this.$http({method:"post",url:e,data:this.template_from}).then(function(e){1==e.data.status?(t.saveAlt.status=!0,t.saveAlt.date=(new Date).toLocaleString(),t.$message({type:"success",message:"操作成功"})):t.$message({type:"error",message:"操作失败"})}).catch(function(t){console.log(t)})}else this.$message({type:"info",message:"请上传图片"})},go_back:function(){this.$router.back()},handleRemove:function(t,e){this.template_from.logo="",document.querySelector(".el-upload--picture-card").classList.remove("none")},logoImgSuccess:function(t,e,a){this.logo_visible=!1,this.template_from.logo=t.url,document.querySelector(".el-upload--picture-card").classList.add("none")},uploadError:function(t,e,a){alert("上传失败，请重试！")},beforeAvatarUpload:function(t){var e=t.name.split("."),a=e.length-1,l="jpg"===e[a],s="png"===e[a],o=t.size/1024/1024<1;return l||s||alert("上传logo只能是 jpg、png 格式!"),o||alert("logo大小不能超过 1MB!"),l||s&&o},handleRemoveImg:function(t,e){this.template_from.picUrls=[];var a=!0,l=!1,o=void 0;try{for(var r,i=s()(e);!(a=(r=i.next()).done);a=!0){var p=r.value;p.response?this.template_from.picUrls.push(p.response.url):this.template_from.picUrls.push(p.url)}}catch(t){l=!0,o=t}finally{try{!a&&i.return&&i.return()}finally{if(l)throw o}}},handleSuccessImg:function(t,e,a){this.template_from.picUrls.push(t.url)},beforeAvatarUploadImg:function(t){var e=t.name.split("."),a=e.length-1,l="jpg"===e[a],s="gif"===e[a],o="png"===e[a],r=t.size/1024/1024<2;return l||s||o||alert("上传模板只能是 jpg、gif、png 格式!"),r||alert("上传图片大小不能超过 2MB!"),l||s||o&&r},deleteTemplate:function(){var t=this;this.$confirm("此操作将永久删除该模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({method:"delete",url:t.apiUrl.templateDelUrl,params:{id:t.template_from.id}}).then(function(e){1==e.data.status?(t.$message({type:"success",message:"删除成功"}),t.$router.push({path:"defaultTemplate"})):t.$message({type:"error",message:"模板正在使用，删除失败"})}).catch(function(e){t.$message({type:"error",message:"删除失败"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}}},VHoT:function(t,e,a){"use strict";function l(t){a("lxz5")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("+0ly"),o=a("pYL7"),r=a("vSla"),i=l,p=r(s.a,o.a,!1,i,null,null);e.default=p.exports},Wpxf:function(t,e,a){e=t.exports=a("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"defaultTemplateNew.vue",sourceRoot:""}])},lxz5:function(t,e,a){var l=a("Wpxf");"string"==typeof l&&(l=[[t.i,l,""]]),l.locals&&(t.exports=l.locals);a("FIqI")("616b91e8",l,!0,{})},pYL7:function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page_create"},[a("div",{staticClass:"page_d_title"},[a("i"),a("span",[t._v(t._s(t.title))])]),t._v(" "),a("div",{staticClass:"page_d_con"},[a("div",{staticClass:"page_d_con_left"},[a("el-form",{ref:"form",attrs:{model:t.template_from,"label-width":"125px"}},[a("el-form-item",{attrs:{label:"产品名称："}},[a("el-select",{staticClass:"f_select1",attrs:{placeholder:"请选择",disabled:t.status.product},model:{value:t.template_from.productID,callback:function(e){t.$set(t.template_from,"productID",e)},expression:"template_from.productID"}},t._l(t.options.product,function(t,e){return a("el-option",{key:t.id,attrs:{label:t.val,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"模板名称："}},[a("el-input",{staticClass:"f_input2",attrs:{placeholder:"请输入模板名称",disabled:t.status.template},model:{value:t.template_from.templateName,callback:function(e){t.$set(t.template_from,"templateName",e)},expression:"template_from.templateName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"apk链接："}},[a("el-input",{staticClass:"f_input2",attrs:{placeholder:"请输入模板apk"},model:{value:t.template_from.apk,callback:function(e){t.$set(t.template_from,"apk",e)},expression:"template_from.apk"}})],1),t._v(" "),a("el-form-item",{staticStyle:{height:"auto"},attrs:{label:"logo："}},[t.logo_visible?a("div",{staticClass:"new_logo"},[a("img",{attrs:{src:t.template_from.logo}})]):t._e(),t._v(" "),a("el-upload",{attrs:{action:t.apiUrl.uploadImgUrl,"with-credentials":!0,"list-type":"picture-card","on-remove":t.handleRemove,beforeUpload:t.beforeAvatarUpload,onError:t.uploadError,"on-success":t.logoImgSuccess}},[a("i",{staticClass:"el-icon-plus"})])],1),t._v(" "),a("el-form-item",{staticClass:"upload_img",attrs:{label:"上传图片："}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:t.apiUrl.uploadImgUrl,"with-credentials":!0,"on-success":t.handleSuccessImg,"on-remove":t.handleRemoveImg,beforeUpload:t.beforeAvatarUploadImg,onError:t.uploadError,"file-list":t.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png/gif文件，且不超过2MB")])],1)],1),t._v(" "),a("el-form-item",{staticClass:"form_button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(t._s(t.but_text))]),t._v(" "),a("el-button",{on:{click:function(e){t.go_back()}}},[t._v("返回")])],1)],1)],1),t._v(" "),a("div",{staticClass:"page_d_con_right"},[a("div",{staticClass:"page_d_current page_create_current"},[a("div",{staticClass:"current_page_title create_page_title"},[t._v("模板预览")]),t._v(" "),a("div",{staticClass:"current_img"},t._l(t.template_from.picUrls,function(t){return a("img",{staticClass:"image",attrs:{src:t.replace(/^\d+@#@/g,"")}})}))]),t._v(" "),a("div",{staticClass:"page_d_alt",class:{none:!t.saveAlt.status}},[t._v("\n                        提示：保存已生效，生效时间："),a("span",[t._v(t._s(t.saveAlt.date))])]),t._v(" "),a("p",{staticClass:"edit delete"},[t.templateDisable?a("button",{staticClass:"el-button button el-button--primary",attrs:{type:"button"},on:{click:t.deleteTemplate}},[a("span",[t._v("删除")])]):t._e()])])])])])},s=[],o={render:l,staticRenderFns:s};e.a=o}});
//# sourceMappingURL=48.2f58d47d4f4a847b0668.js.map