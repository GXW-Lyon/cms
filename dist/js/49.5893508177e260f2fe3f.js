webpackJsonp([49],{"09RY":function(e,t,a){t=e.exports=a("UTlt")(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"realTimeDataUpdate.vue",sourceRoot:""}])},HtI3:function(e,t,a){var i=a("09RY");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("FIqI")("0967d542",i,!0,{})},O1cN:function(e,t,a){"use strict";function i(e){a("HtI3")}Object.defineProperty(t,"__esModule",{value:!0});var s=a("VYvP"),l=a("o3Bs"),n=a("vSla"),o=i,c=n(s.a,l.a,!1,o,null,null);t.default=c.exports},VYvP:function(e,t,a){"use strict";var i=a("HzJ8"),s=a.n(i);t.a={data:function(){return{proModelValue:[],loading:!1,multipleStatus:!1,visibleMenuSelectStatus:!1,importTitleStatus:!1,importTitleTxt:"",checkAll:!0,checkedCities:["日期","客户名称","产品名称","原渠道名称","新渠道名称","上游渠道号","结算激活"],cities:["日期","客户名称","产品名称","原渠道名称","新渠道名称","上游渠道号","预估激活","结算激活","留存率","详情"],citiesFilterVal:["dataTime","customerName","productName","channelName","newChannelName","productChannelCode","expectedAct","settlementAct","retention","desc"],table_column:[{fixed:!0,prop:"dataTime",label:"日期",sortable:!0,visible:!0},{fixed:!1,prop:"customerName",label:"客户名称",sortable:!1,visible:!0},{fixed:!1,prop:"productName",label:"产品名称",sortable:!1,visible:!0},{fixed:!1,prop:"productChannelCode",label:"上游渠道号",sortable:!1,visible:!0,width:280},{fixed:!1,prop:"channelName",label:"原渠道名称",sortable:!1,visible:!0},{fixed:!1,prop:"newChannelName",label:"新渠道名称",sortable:!1,visible:!0},{fixed:!1,prop:"expectedAct",label:"预估激活",sortable:!1,visible:!1},{fixed:!1,prop:"settlementAct",label:"结算激活",sortable:!1,visible:!0},{fixed:!1,prop:"retention",label:"留存率",sortable:!1,visible:!1,format:function(e,t){return"button"!=e.validStatus?e.retention+"%":""}},{fixed:!1,prop:"desc",label:"详情",sortable:!1,visible:!1}],menu_nav:["CPA数据管理","实时数据刷新"],tableData:[],tableDataObj:{},dateValue:"",customer_items:{model_value:"",placeHolder:"客户",options:[]},pro_items:{model_value:"",placeHolder:"产品",options:[]},channelPro_items:{model_value:"",placeHolder:"上游渠道号",options:[]},channel_items:{model_value:"",placeHolder:"渠道",options:[]},params:{type:"",val:"",startDate:"",endDate:""},pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}}]},activeName:"updatedRealtimeDatas",isFirstEnter:!1}},activated:function(){this.$route.meta.isBack&&!this.isFirstEnter||this.customerSelect(),this.$route.meta.isBack=!1,this.isFirstEnter=!1},created:function(){this.isFirstEnter=!0},methods:{customerSelect:function(){var e=this;this.$http({method:"get",url:this.apiUrl.customerSearch,params:{offset:1,limit:9999,val:""}}).then(function(t){if(200==t.status){var a=t.data;e.customer_items.options=a.items}}).catch(function(e){console.log(e)})},proInfo:function(){var e=this;this.$http({method:"get",url:this.apiUrl.customerProListLight,params:{customerCode:this.customer_items.model_value}}).then(function(t){if(200==t.status){var a=t.data;e.pro_items.options=a.items,e.proModelValue=[]}}).catch(function(e){console.log(e)})},channelProInfo:function(){var e=this;this.$http({method:"get",url:this.apiUrl.customerProSearch,params:{offset:1,limit:9999,type:2,code:this.proModelValue.join("|")}}).then(function(t){if(200==t.status){var a=t.data;e.channelPro_items.options=a.items,e.channelPro_items.model_value=""}}).catch(function(e){console.log(e)})},channelInfo:function(){var e=this;this.$http({method:"get",url:this.apiUrl.channelProSearch,params:{offset:1,limit:9999,type:4,code:this.channelPro_items.model_value}}).then(function(t){if(200==t.status){var a=t.data;e.channel_items.options=a.items,e.channel_items.model_value=""}}).catch(function(e){console.log(e)})},select:function(e,t){if(""!=t)switch(this.params.type=e,this.params.val=t,e){case"1":this.proInfo();break;case"2":this.params.val=t.join("|"),t.length<=1?(this.multipleStatus=!1,this.channelProInfo()):this.multipleStatus=!0;break;case"3":this.channelInfo()}},pageInfo:function(){var e=this;return""==this.params.startDate||""==this.params.endDate?(this.$message({type:"info",message:"请选择时间"}),!1):""==this.customer_items.model_value?(this.$message({type:"info",message:"请选择客户"}),!1):0==this.proModelValue.length?(this.$message({type:"info",message:"请选择产品"}),!1):(this.loading=!0,void this.$http({method:"get",url:this.apiUrl.realtimeRefresh,params:{type:this.params.type,searchKey:this.params.val,sDataTime:this.params.startDate,eDataTime:this.params.endDate}}).then(function(t){if(console.log(t),e.loading=!1,t.status=200){e.checkAll=!0;var a=t.data;"updatedRealtimeDatas"==e.activeName&&a.updatedRealtimeDatas.length>0&&a.updatedRealtimeDatas.unshift({validStatus:"button"}),e.tableDataObj=a,e.tableData=a[e.activeName]}}).catch(function(t){e.loading=!1}))},checkedChange:function(){var e=!0,t=!1,a=void 0;try{for(var i,l=s()(this.table_column);!(e=(i=l.next()).done);e=!0){var n=i.value,o=this.checkedCities.indexOf(n.label);n.visible=o>=0}}catch(e){t=!0,a=e}finally{try{!e&&l.return&&l.return()}finally{if(t)throw a}}},changeCheckStatus:function(e){e.stopPropagation(),this.visibleMenuSelectStatus=!this.visibleMenuSelectStatus},bodyEvent:function(){this.visibleMenuSelectStatus=!1},preventDefault:function(e){e.stopPropagation()},changeInput:function(e){return e},exitImportTitle:function(){this.importTitleStatus=!1,this.pageInfo()},dateChange:function(){this.params.startDate=this.formatDateTime(this.dateValue[0],"y-m-d"),this.params.endDate=this.formatDateTime(this.dateValue[1],"y-m-d")},checkAllEvent:function(){var e=!0,t=!0,a=!1,i=void 0;try{for(var l,n=s()(this.tableData);!(t=(l=n.next()).done);t=!0){var o=l.value;"button"!=o.validStatus&&(o.validStatus=this.checkAll,e=!1)}}catch(e){a=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw i}}if(e)return!1;this.checkAll=!this.checkAll},importData:function(){if(0==this.tableData.length)return this.$message({type:"info",message:"无可导出数据"}),!1;console.log(this.tableData);var e=this.cities,t=this.citiesFilterVal,a=this.tableData,i=[this.params.startDate,this.params.endDate,this.customer_items.model_value,this.proModelValue.join("|"),this.channelPro_items.model_value,this.channel_items.model_value,this.activeName,"实时数据刷新"].join("_");this.handleDownload(e,t,a,i)},handleClick:function(e,t){if("updatedRealtimeDatas"==this.activeName)this.checkedCities.push("新渠道名称");else{var a=this.checkedCities.indexOf("新渠道名称");a>-1&&this.checkedCities.splice(a,1)}this.checkedChange(),this.tableData=this.tableDataObj[this.activeName]||[]},modify:function(){var e=this;this.idList=[];var t=!0,a=!1,i=void 0;try{for(var l,n=s()(this.tableData);!(t=(l=n.next()).done);t=!0){var o=l.value;o.validStatus&&"button"!=o.validStatus&&this.idList.push({id:o.id,channelInfo:o.newChannelName})}}catch(e){a=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw i}}if(console.log(this.idList),0==this.idList.length)return this.$message({type:"info",message:"请选择待刷新数据"}),!1;this.$http({method:"post",url:this.apiUrl.realtimeUpdateChannel,data:{list:this.idList}}).then(function(t){console.log(t),(t.status=200)&&("2"==t.data.status?e.$message({type:"success",message:"修改成功"}):e.$message({type:"error",message:"修改失败"}))}).catch(function(e){})}}}},o3Bs:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"info_flow_content",on:{click:e.bodyEvent}},[a("div",{staticClass:"menuNav"},[a("p",[a("i",{staticClass:"nav_index"}),e._l(e.menu_nav,function(t,i){return a("span",{key:i},[a("i",{staticClass:"el-icon-arrow-right"}),a("em",[e._v(e._s(t))])])})],2)]),e._v(" "),a("div",{staticClass:"info_ad_search"},[a("div",{staticClass:"info_a_s_content"},[a("div",{staticClass:"dateSelect"},[a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration"},[e._v("选择日期")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange",align:"right",placeholder:"选择日期范围",format:"yyyy / MM / dd","picker-options":e.pickerOptions2},on:{change:e.dateChange},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),a("div",{staticClass:"dateBut"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.importData(t)}}},[a("i",{staticClass:"el-icon-plus"}),e._v("导出数据\n                        ")])],1)]),e._v(" "),a("div",{staticClass:"realTimeCitySearch"},[a("el-select",{staticClass:"con_select unBorderRadius",attrs:{placeholder:e.customer_items.placeHolder,filterable:""},on:{change:function(t){e.select("1",e.customer_items.model_value)}},model:{value:e.customer_items.model_value,callback:function(t){e.$set(e.customer_items,"model_value",t)},expression:"customer_items.model_value"}},e._l(e.customer_items.options,function(e){return a("el-option",{key:e.customerCode,attrs:{label:e.name,value:e.customerCode}})})),e._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{placeholder:e.pro_items.placeHolder,multiple:""},on:{change:function(t){e.select("2",e.proModelValue)}},model:{value:e.proModelValue,callback:function(t){e.proModelValue=t},expression:"proModelValue"}},e._l(e.pro_items.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.productName,value:e.customerProductCode}})})),e._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{disabled:e.multipleStatus,placeholder:e.channelPro_items.placeHolder,filterable:""},on:{change:function(t){e.select("3",e.channelPro_items.model_value)}},model:{value:e.channelPro_items.model_value,callback:function(t){e.$set(e.channelPro_items,"model_value",t)},expression:"channelPro_items.model_value"}},e._l(e.channelPro_items.options,function(e){return a("el-option",{key:e.productPackageCode,attrs:{label:e.productChannelCode,value:e.productPackageCode}})})),e._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{disabled:e.multipleStatus,placeholder:e.channel_items.placeHolder},on:{change:function(t){e.select("4",e.channel_items.model_value)}},model:{value:e.channel_items.model_value,callback:function(t){e.$set(e.channel_items,"model_value",t)},expression:"channel_items.model_value"}},e._l(e.channel_items.options,function(e){return a("el-option",{key:e.channelProductCode,attrs:{label:e.channelName,value:e.channelProductCode}})})),e._v(" "),a("el-button",{staticClass:"page_d_s_button",on:{click:e.pageInfo}},[e._v("刷新")])],1)])]),e._v(" "),a("div",{staticClass:"info_ad_table"},[a("div",{staticClass:"page_d_title"},[a("i",{staticStyle:{visibility:"hidden"}}),a("span"),e._v(" "),a("div",{staticClass:"tableVisibleMenu"},[a("p",{staticClass:"visibleMenuBut",on:{click:function(t){e.changeCheckStatus(t)}}}),e._v(" "),e.visibleMenuSelectStatus?a("div",{staticClass:"visibleMenuSelect",on:{click:function(t){e.preventDefault(t)}}},[a("el-checkbox-group",{attrs:{min:1},on:{change:e.checkedChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,function(t){return a("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(t))])}))],1):e._e()])]),e._v(" "),a("div",{staticClass:"tabs"},[[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"待刷新数据",name:"updatedRealtimeDatas"}},[a("el-button",{staticClass:"page_d_s_button",staticStyle:{float:"right"},on:{click:e.modify}},[e._v("确认修改")])],1),e._v(" "),a("el-tab-pane",{attrs:{label:"已参与结算",name:"billedRealtimeDatas"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"渠道时间冲突",name:"errorRealtimeDatas"}})],1)]],2),e._v(" "),a("div",{staticClass:"tableDetail"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中",data:e.tableData,border:"",stripe:""}},[e._l(e.table_column,function(t,i){return t.visible?a("el-table-column",{key:t.prop,attrs:{fixed:t.fixed,sortable:t.sortable,prop:t.prop,label:t.label,formatter:t.format,width:t.width,"min-width":"100"}}):e._e()}),e._v(" "),"updatedRealtimeDatas"==e.activeName?a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100","min-width":"100","class-name":"exitBut"},scopedSlots:e._u([{key:"default",fn:function(t){return["button"==t.row.validStatus?a("span",{staticClass:"r_span",on:{click:e.checkAllEvent}},[e._v(e._s(e.checkAll?"全选":"取消全选"))]):a("el-checkbox",{model:{value:t.row.validStatus,callback:function(a){e.$set(t.row,"validStatus",a)},expression:"scope.row.validStatus"}})]}}])}):e._e()],2)],1)]),e._v(" "),e.importTitleStatus?a("div",{staticClass:"importTitle",on:{click:function(e){e.stopPropagation()}}},[a("div",{staticClass:"importTitle_top"},[a("span",[e._v("提示")]),e._v(" "),a("button",{on:{click:function(t){return t.stopPropagation(),e.exitImportTitle(t)}}},[e._v("×")])]),e._v(" "),a("div",{staticClass:"importTitleTxt",domProps:{innerHTML:e._s(e.importTitleTxt)}})]):e._e()])])},s=[],l={render:i,staticRenderFns:s};t.a=l}});
//# sourceMappingURL=49.5893508177e260f2fe3f.js.map