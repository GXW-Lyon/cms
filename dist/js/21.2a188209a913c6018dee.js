webpackJsonp([21],{BPkO:function(t,e,a){e=t.exports=a("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"proManaNew.vue",sourceRoot:""}])},G5CB:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page_create customerInfoNew"},[a("div",{staticClass:"menuNav"},[a("p",[a("i",{staticClass:"nav_index"}),t._l(t.menu_nav,function(e,o){return a("span",{key:o},[a("i",{staticClass:"el-icon-arrow-right"}),a("em",[t._v(t._s(e))])])})],2)]),t._v(" "),a("div",{staticClass:"page_d_title"},[a("i"),a("span",[t._v(t._s(t.title))])]),t._v(" "),a("div",{staticClass:"page_d_con"},[a("div",{staticClass:"page_d_con_left"},[a("el-form",{ref:"form",attrs:{model:t.proInfo,"label-width":"125px"}},[a("div",{staticClass:"banner_part_line page_create_set_line"},[t._v("账号信息")]),t._v(" "),a("el-form-item",{attrs:{label:"选择平台："}},[a("el-select",{staticClass:"f_select1",attrs:{filterable:"",placeholder:"请选择"},on:{change:t.platformSelct},model:{value:t.proInfo.platformId,callback:function(e){t.$set(t.proInfo,"platformId",e)},expression:"proInfo.platformId"}},t._l(t.platform_items.options,function(t,e){return a("el-option",{key:t.platformId,attrs:{label:t.platformName,value:t.platformId}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"客户名称："}},[a("el-select",{staticClass:"f_select1",attrs:{filterable:"",placeholder:"请选择"},model:{value:t.proInfo.customId,callback:function(e){t.$set(t.proInfo,"customId",e)},expression:"proInfo.customId"}},t._l(t.customer_items.options,function(t,e){return a("el-option",{key:t.id,attrs:{label:t.customerName,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"产品名称："}},[a("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.proInfo.productName,callback:function(e){t.$set(t.proInfo,"productName",e)},expression:"proInfo.productName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"添加预算："}},[a("el-input",{style:{"margin-right":"10px"},attrs:{placeholder:"请输入预算"},model:{value:t.proInfo.budget,callback:function(e){t.$set(t.proInfo,"budget",e)},expression:"proInfo.budget"}}),t._v("\n                        元\n                    ")],1),t._v(" "),a("el-form-item",{staticStyle:{height:"auto",position:"relative"},attrs:{label:"返点比例："}},[t._l(t.proInfo.rebateList,function(e,o){return a("el-form-item",{key:o},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:function(a){t.dateChange(e.time,o)}},model:{value:e.time,callback:function(a){t.$set(e,"time",a)},expression:"item.time"}}),t._v(" "),a("el-input",{style:{margin:"0 10px"},attrs:{type:"number",placeholder:"请输入返点比例"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}),t._v("\n                            %\n                        ")],1)}),t._v(" "),a("div",{staticClass:"addRow"},[a("el-button",{on:{click:function(e){t.addRow()}}},[t._v("添加一行")])],1)],2),t._v(" "),a("el-form-item",{staticClass:"form_button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确认")]),t._v(" "),a("el-button",{on:{click:function(e){t.go_back()}}},[t._v("返回")])],1),t._v(" "),t.relationStatus?a("div",[a("div",{staticClass:"banner_part_line page_create_set_line"},[t._v("添加关联账号")]),t._v(" "),a("el-form-item",{staticStyle:{height:"auto",position:"relative"},attrs:{label:"关联账号："}},[a("div",{staticClass:"checkGroupBox"},[a("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.checks,function(t,e){return a("el-checkbox",{key:t.id,attrs:{label:t.name}})}))],1)]),t._v(" "),a("el-form-item",{staticClass:"form_button"},[a("el-button",{attrs:{type:"primary",disabled:!t.relationBtnStatus,title:t.relationBtnStatus?null:"请先提交账号信息，再添加关联账号"},on:{click:t.relatAccount}},[t._v("确认\n                            ")]),t._v(" "),a("el-button",{attrs:{disabled:!t.relationBtnStatus},on:{click:function(e){t.go_back()}}},[t._v("返回")])],1)],1):t._e()],1)],1)])])])},s=[],r={render:o,staticRenderFns:s};e.a=r},SGt4:function(t,e,a){"use strict";var o=a("HzJ8"),s=a.n(o);e.a={data:function(){return{dateValue:"",title:"创建产品信息",menu_nav:["信息流数据管理","产品管理","创建产品信息"],checks:[],checkList:[],relationList:[],relationStatus:!1,relationBtnStatus:!1,proInfo:{budget:"",customId:"",platformId:"",productName:"",rebateList:[{time:"",value:""}]},productId:"",platform_items:{model_value:"",placeHolder:"平台",options:[]},customer_items:{model_value:"",placeHolder:"客户",options:[]}}},created:function(){this.platform(),this.customer()},methods:{platform:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpPlaGetPlatformList}).then(function(e){if(200==e.status){var a=e.data;t.platform_items.options=a}}).catch(function(t){console.log(t)})},customer:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpCusGetCustomerList}).then(function(e){if(200==e.status){var a=e.data;t.customer_items.options=a,t.customer_items.model_value=""}}).catch(function(t){console.log(t)})},account:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpAccSearchAccount,params:{offset:1,limit:9999,platformId:this.proInfo.platformId}}).then(function(e){if(200==e.status){var a=e.data;t.checks=[];var o=!0,r=!1,i=void 0;try{for(var n,l=s()(a.items);!(o=(n=l.next()).done);o=!0){var c=n.value;null==c.productName&&t.checks.push(c)}}catch(t){r=!0,i=t}finally{try{!o&&l.return&&l.return()}finally{if(r)throw i}}}}).catch(function(t){console.log(t)})},onSubmit:function(){var t=this;for(var e in this.proInfo){if("budget"!=e&&"rebateList"!=e&&""==this.proInfo[e])return this.$message({type:"info",message:"请完善平台、客户名称和产品名称"}),!1;if("rebateList"==e){for(var a=this.proInfo[e],o=a.length,s=0;s<o;s++)""!=a[s].time&&""!=a[s].value||(a.splice(s,1),s--,o=a.length);0==o&&this.addRow()}}this.$http({method:"post",url:this.apiUrl.fdpProCreate,data:this.proInfo}).then(function(e){if(console.log(e),200==e.status){var a=e.data;1==a.status?(t.$message({type:"success",message:a.msg}),t.productId=a.id,t.checks.length>0&&(t.relationBtnStatus=!0)):t.$message({type:"error",message:a.msg})}else t.$message({type:"error",message:"创建失败，请完善信息，并重新提交"})}).catch(function(e){console.log(e),t.$message({type:"error",message:"请完善信息，并重新提交"})})},go_back:function(){this.$router.back()},dateChange:function(t,e){this.proInfo.rebateList[e].time=""!=t&&void 0!==t&&null!=t?this.formatDateTime(new Date(t),"y-m-d"):""},relatAccount:function(){var t=this;this.relationList=[];var e=!0,a=!1,o=void 0;try{for(var r,i=s()(this.checkList);!(e=(r=i.next()).done);e=!0){var n=r.value,l=!0,c=!1,u=void 0;try{for(var f,p=s()(this.checks);!(l=(f=p.next()).done);l=!0){var m=f.value;m.name===n&&this.relationList.push({accountId:m.id,accountName:m.name})}}catch(t){c=!0,u=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw u}}}}catch(t){a=!0,o=t}finally{try{!e&&i.return&&i.return()}finally{if(a)throw o}}this.$http({method:"post",url:this.apiUrl.fdpProSave_product_account,data:{list:this.relationList,platformId:this.proInfo.platformId,productId:this.productId,productName:this.proInfo.productName}}).then(function(e){if(console.log(e),200==e.status){var a=e.data;1==a.status?(t.$message({type:"success",message:a.msg}),t.go_back()):t.$message({type:"error",message:a.msg})}else t.$message({type:"error",message:"关联失败，请完善信息，并重新提交"})}).catch(function(e){console.log(e),t.$message({type:"error",message:"请完善信息，并重新提交"})})},addRow:function(){var t=!0,e=!1,a=void 0;try{for(var o,r=s()(this.proInfo.rebateList);!(t=(o=r.next()).done);t=!0){var i=o.value;if(""==i.time||""==i.value)return this.$message({type:"info",message:"请完善返点比例信息再添加新行"}),!1}}catch(t){e=!0,a=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}this.proInfo.rebateList.push({time:"",value:""})},platformSelct:function(){this.relationStatus=!0,console.log(),this.account()}}}},TLzn:function(t,e,a){var o=a("BPkO");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("FIqI")("70e4fa6f",o,!0,{})},"iQ4+":function(t,e,a){"use strict";function o(t){a("TLzn")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("SGt4"),r=a("G5CB"),i=a("vSla"),n=o,l=i(s.a,r.a,!1,n,null,null);e.default=l.exports}});
//# sourceMappingURL=21.2a188209a913c6018dee.js.map