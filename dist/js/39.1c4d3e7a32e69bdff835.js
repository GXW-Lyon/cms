webpackJsonp([39],{"2lw3":function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"page_create customerContractNew"},[o("div",{staticClass:"menuNav"},[o("p",[o("i",{staticClass:"nav_index"}),t._l(t.menu_nav,function(e,r){return o("span",{key:r},[o("i",{staticClass:"el-icon-arrow-right"}),o("em",[t._v(t._s(e))])])})],2)]),t._v(" "),o("div",{staticClass:"page_d_title"},[o("i"),o("span",[t._v(t._s(t.pageTitle))])]),t._v(" "),o("div",{staticClass:"page_d_con"},[o("div",{staticClass:"page_d_con_left cpa_page_left",class:{page_d_con_left_widthAll:!t.isRightBox}},[o("div",{staticClass:"banner_part_line page_create_set_line"},[t._v("合同信息")]),t._v(" "),o("el-form",{ref:"form",attrs:{model:t.contract_from,"label-width":"125px"}},[o("el-form-item",{attrs:{label:"客户主体："}},[o("el-select",{staticClass:"f_select1 inlineBlock",attrs:{placeholder:"请选择",disabled:t.isabled},on:{change:function(e){t.cusSelect()}},model:{value:t.contract_from.customerCode,callback:function(e){t.$set(t.contract_from,"customerCode",e)},expression:"contract_from.customerCode"}},t._l(t.options.customer,function(t,e){return o("el-option",{key:t.customerCode,attrs:{label:t.customerName,value:t.customerCode}})})),t._v(" "),o("el-radio-group",{staticClass:"f_radio1 inlineBlock",on:{change:t.checkFrom},model:{value:t.contract_from.isOwner,callback:function(e){t.$set(t.contract_from,"isOwner",e)},expression:"contract_from.isOwner"}},[o("el-radio",{attrs:{label:2,disabled:t.isabled}},[t._v("甲方")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"我方主体："}},[o("el-select",{staticClass:"f_select1 inlineBlock",attrs:{placeholder:"请选择",disabled:t.isabled},on:{change:t.checkFrom},model:{value:t.contract_from.kyhdType,callback:function(e){t.$set(t.contract_from,"kyhdType",e)},expression:"contract_from.kyhdType"}},t._l(t.options.kyhd,function(t,e){return o("el-option",{key:t.id,attrs:{label:t.val,value:t.id}})})),t._v(" "),o("el-radio-group",{staticClass:"f_radio1 inlineBlock",on:{change:t.checkFrom},model:{value:t.contract_from.isOwner,callback:function(e){t.$set(t.contract_from,"isOwner",e)},expression:"contract_from.isOwner"}},[o("el-radio",{attrs:{label:1,disabled:t.isabled}},[t._v("甲方")])],1)],1),t._v(" "),o("el-form-item",{staticStyle:{height:"auto",position:"relative"},attrs:{label:"客户产品："}},[t._l(t.options.product,function(e,r){return o("el-form-item",{key:r},[o("el-select",{staticClass:"f_select1 inlineBlock",attrs:{placeholder:e.placeHolder,clearable:"","value-key":"productId",disabled:t.isabled},on:{change:function(o){t.proSelect(r,e.model_value)}},model:{value:e.model_value,callback:function(o){t.$set(e,"model_value",o)},expression:"item.model_value"}},t._l(e.items,function(t,e){return o("el-option",{key:t.productId,attrs:{label:t.productName,value:t}})}))],1)}),t._v(" "),t.isabled?t._e():o("div",{staticClass:"addRow",staticStyle:{left:"225px"}},[o("el-button",{on:{click:t.addRow}},[t._v("添加一行")])],1)],2),t._v(" "),o("el-form-item",{attrs:{label:"合同有效日期："}},[o("el-date-picker",{attrs:{type:"daterange",align:"right",placeholder:"选择日期范围",format:"yyyy/MM/dd","picker-options":t.$store.state.pickerOptions2,disabled:t.isabled},on:{change:t.dateChange},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"合同编号："}},[o("el-input",{attrs:{placeholder:"请输入合同编号",disabled:""},model:{value:t.contract_from.contractNo,callback:function(e){t.$set(t.contract_from,"contractNo",e)},expression:"contract_from.contractNo"}})],1),t._v(" "),o("el-form-item",{staticClass:"form_button"},[t.isabled?t._e():o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确认")]),t._v(" "),o("el-button",{on:{click:function(e){t.go_back()}}},[t._v("返回")])],1)],1)],1)])])])},a=[],c={render:r,staticRenderFns:a};e.a=c},"7iIP":function(t,e,o){"use strict";var r=o("aA9S"),a=o.n(r),c=o("hRKE"),s=o.n(c),i=o("HzJ8"),n=o.n(i);e.a={data:function(){return{isRightBox:!1,isabled:!1,menu_nav:["信息流数据管理","客户合同管理","创建合同信息"],dateValue:"",contract_from:{beginTime:"",contractNo:"",customerCode:"",platformCode:"",endTime:"",id:0,isOwner:1,kyhdType:"",marketingMode:"XN",productItems:[]},options:{customer:[],kyhd:[{id:"Y1",val:"深圳康远互动科技有限公司"},{id:"Y2",val:"霍尔果斯康远互动网络科技有限公司"},{id:"Y3",val:"上海贝玩网络科技有限公司"},{id:"Y4",val:"深圳自由泰格互动科技有限公司"}],product:[{placeHolder:"请选择",model_value:{},items:[]}]},customerContractId:"",pageTitle:"创建合同信息"}},created:function(){this.customerSelect()},methods:{customerSelect:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpCusGetCustomerList,params:{offset:1,limit:9999,val:""}}).then(function(e){if(200==e.status){var o=e.data;t.options.customer=o}}).catch(function(t){console.log(t)})},proInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpProListall,params:{customerCode:this.contract_from.customerCode,platformId:-1}}).then(function(e){if(200==e.status){var o=e.data;t.options.product=t.options.product.map(function(t,e){return{placeHolder:"请选择",model_value:"",items:o}});for(var r=1;r<t.contract_from.productItems.length;r++)t.addRow();""==t.customerContractId?t.contract_from.productItems=[]:t.options.product.forEach(function(e,o){var r=!0,a=!1,c=void 0;try{for(var s,i=n()(e.items);!(r=(s=i.next()).done);r=!0){var l=s.value;l.id==t.contract_from.productItems[o].id&&(e.model_value=l)}}catch(t){a=!0,c=t}finally{try{!r&&i.return&&i.return()}finally{if(a)throw c}}})}}).catch(function(t){console.log(t)})},cusSelect:function(){this.proInfo()},proSelect:function(t,e){this.options.product.model_value=e,"object"==(void 0===e?"undefined":s()(e))&&""!=e&&(this.contract_from.productItems[t]||this.contract_from.productItems.push({id:"",productNo:""}),this.contract_from.productItems[t].id=e.productId,this.contract_from.productItems[t].productNo=e.productId),""==e&&(this.contract_from.productItems[t]||this.contract_from.productItems.push({id:"",productNo:""}),this.contract_from.productItems[t].id="",this.contract_from.productItems[t].productNo=""),this.checkFrom()},addRow:function(){if(""!=this.options.product.model_value&&void 0!=this.options.product.model_value){var t=a()({},this.options.product[0]);this.options.product.push(t)}},checkFrom:function(){var t=this.contract_from;if(""!=t.customerCode&&""!=t.kyhdType&&t.productItems.length>0&&""!=t.beginTime){var e=Math.ceil(this.datedifference(t.beginTime,t.endTime)/365),o=t.beginTime.replace(/-/g,""),r=t.productItems[0].productNo;1==t.isOwner?this.contract_from.contractNo=t.kyhdType+t.customerCode+r+"XN"+o+e:2==this.contract_from.isOwner&&(this.contract_from.contractNo=t.customerCode+t.kyhdType+r+"XN"+o+e)}else this.contract_from.contractNo=""},onSubmit:function(){for(var t=this,e=this.contract_from,o=this.apiUrl.fdpConNewCustomer,r=0;r<e.productItems.length;r++)""==e.productItems[r].productNo&&(e.productItems.splice(r,1),r--);""!=e.customerCode&&""!=e.kyhdType&&e.productItems.length>0&&""!=e.beginTime?this.$http({method:"post",url:o,data:this.contract_from}).then(function(e){e.data;200==e.status?(t.$message({type:"success",message:"操作成功"}),t.go_back()):t.$message({type:"error",message:"操作失败，请完善信息，并重新提交"})}).catch(function(e){t.$message({type:"error",message:"操作失败，请完善信息，并重新提交"})}):this.$message({type:"error",message:"操作失败，请完善信息，并重新提交"})},go_back:function(){this.$router.back()},dateChange:function(){var t=this.dateValue;t.length>0&&(this.contract_from.beginTime=this.formatDateTime(t[0],"y-m-d"),this.contract_from.endTime=this.formatDateTime(t[1],"y-m-d")),this.checkFrom()}}}},Ym1q:function(t,e,o){e=t.exports=o("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"cusContractNew.vue",sourceRoot:""}])},k3Yb:function(t,e,o){var r=o("Ym1q");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);o("FIqI")("4578b930",r,!0,{})},ynYy:function(t,e,o){"use strict";function r(t){o("k3Yb")}Object.defineProperty(e,"__esModule",{value:!0});var a=o("7iIP"),c=o("2lw3"),s=o("vSla"),i=r,n=s(a.a,c.a,!1,i,null,null);e.default=n.exports}});
//# sourceMappingURL=39.1c4d3e7a32e69bdff835.js.map