webpackJsonp([38],{Cnqc:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"info_flow_content",on:{click:t.bodyEvent}},[a("div",{staticClass:"menuNav"},[a("p",[a("i",{staticClass:"nav_index"}),t._l(t.menu_nav,function(e,i){return a("span",{key:i},[a("i",{staticClass:"el-icon-arrow-right"}),a("em",[t._v(t._s(e))])])})],2)]),t._v(" "),a("div",{staticClass:"info_ad_search"},[a("div",{staticClass:"info_a_s_content"},[a("div",{staticClass:"dateSelect"},[a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration"},[t._v("对账日期")]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange",align:"right",placeholder:"选择日期范围",format:"yyyy / MM / dd","picker-options":t.pickerOptions2},on:{change:t.dateChange},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),t._v(" "),a("el-select",{staticClass:"con_select unBorderRadius selectMaxWidth",attrs:{clearable:"",placeholder:t.customer_items.placeHolder,filterable:""},model:{value:t.customer_items.model_value,callback:function(e){t.$set(t.customer_items,"model_value",e)},expression:"customer_items.model_value"}},t._l(t.customer_items.options,function(t){return a("el-option",{key:t.id,attrs:{label:t.customerName,value:t.id}})})),t._v(" "),a("el-select",{staticClass:"con_select unBorderRadius selectMaxWidth",attrs:{clearable:"",placeholder:t.pay_items.placeHolder},model:{value:t.pay_items.model_value,callback:function(e){t.$set(t.pay_items,"model_value",e)},expression:"pay_items.model_value"}},t._l(t.$store.getters.fdpDingStatus,function(t){return a("el-option",{key:t.id,attrs:{label:t.val,value:t.id}})})),t._v(" "),a("el-button",{staticClass:"page_d_s_button",on:{click:t.pageInfo}},[t._v("查询")])],1),t._v(" "),a("div",{staticClass:"dateBut",staticStyle:{"margin-top":"0 !important"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.importData(e)}}},[t._v("导出数据\n                            ")])],1)]),t._v(" "),a("div",{staticClass:"realTimeCitySearch"},[a("el-input",{staticClass:"page_d_select",attrs:{placeholder:"请输入对账单编号"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.searchBill(e):null}},model:{value:t.billNo,callback:function(e){t.billNo=e},expression:"billNo"}}),t._v(" "),a("el-button",{staticClass:"page_d_s_button",on:{click:function(e){return e.stopPropagation(),t.searchBill(e)}}},[t._v("搜索")])],1)])]),t._v(" "),a("div",{staticClass:"info_ad_table"},[a("div",{staticClass:"page_d_title"},[a("i",{staticStyle:{visibility:"hidden"}}),a("span"),t._v(" "),a("div",{staticClass:"tableVisibleMenu"},[a("p",{staticClass:"visibleMenuBut",on:{click:function(e){return e.stopPropagation(),t.changeCheckStatus(e)}}}),t._v(" "),t.visibleMenuSelectStatus?a("div",{staticClass:"visibleMenuSelect",on:{click:function(t){t.stopPropagation()}}},[a("el-checkbox-group",{attrs:{min:1},on:{change:t.checkedChange},model:{value:t.checkedCities,callback:function(e){t.checkedCities=e},expression:"checkedCities"}},t._l(t.cities,function(e){return a("el-checkbox",{key:e,attrs:{label:e}},[t._v(t._s(e))])}))],1):t._e()])]),t._v(" "),a("div",{staticClass:"tableDetail"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中",data:t.tableData,border:"",stripe:""}},[t._l(t.table_column,function(e,i){return e.visible?a("el-table-column",{key:e.prop,attrs:{fixed:e.fixed,sortable:e.sortable,prop:e.prop,label:e.label,formatter:e.format,width:"auto","min-width":e.minwidth}}):t._e()}),t._v(" "),a("el-table-column",{attrs:{label:"实际结算金额","min-width":"150","class-name":"exitInput"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-input",{staticStyle:{width:"80%!important"},attrs:{type:"number",placeholder:""},model:{value:e.row.actualAmout,callback:function(a){t.$set(e.row,"actualAmout",a)},expression:"scope.row.actualAmout"}})],1)]}}])}),t._v(" "),t._l(t.tabale_column_one,function(e,i){return e.visible?a("el-table-column",{key:e.prop,attrs:{fixed:e.fixed,sortable:e.sortable,prop:e.prop,label:e.label,formatter:e.format,width:"auto","min-width":e.minwidth}}):t._e()}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"对账单",width:"80","min-width":"80","class-name":"exitBut"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){a.stopPropagation(),t.seeBill(e.row.id)}}},[a("span",{staticClass:"r_span"},[t._v("查看")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80","min-width":"80","class-name":"exitBut"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){a.stopPropagation(),t.deleteBill(e.row.id)}}},[a("span",{staticClass:"r_span"},[t._v("删除")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"审批",width:"80","min-width":"80","class-name":"exitBut"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.payStatus?a("div",{on:{click:function(a){a.stopPropagation(),t.submitBill(e)}}},[a("span",{staticClass:"r_span"},[t._v("提交")])]):a("div",[a("span",{staticClass:"r_span"})])]}}])})],2)],1)]),t._v(" "),a("div",{staticClass:"con_pager"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.page.currentPage,"page-sizes":t.page.sizes,"page-size":t.page.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.page.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.page,"currentPage",e)}}})],1)]),t._v(" "),t.billStatus?a("div",{staticClass:"bill",on:{click:function(t){t.stopPropagation()}}},[a("div",{staticClass:"bill_title"},[a("span",[t._v("对账单")]),t._v(" "),a("button",{on:{click:function(e){return e.stopPropagation(),t.exitBill(e)}}},[t._v("×")])]),t._v(" "),a("div",{staticClass:"bill_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataBill,border:"",stripe:""}},t._l(t.table_column_bill_title,function(e,i){return e.visible?a("el-table-column",{key:i,attrs:{fixed:e.fixed,sortable:e.sortable,formatter:e.format,prop:e.prop,label:e.label,width:""}}):t._e()}))],1),t._v(" "),a("div",{staticClass:"bill_table_detail"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataBillDetail,border:"",stripe:""}},t._l(t.table_column_bill_detail,function(e,i){return e.visible?a("el-table-column",{key:i,attrs:{fixed:e.fixed,sortable:e.sortable,formatter:e.format,prop:e.prop,label:e.label,width:""}}):t._e()}))],1)]):t._e()])])},l=[],s={render:i,staticRenderFns:l};e.a=s},Fweb:function(t,e,a){e=t.exports=a("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"customerAccount.vue",sourceRoot:""}])},M8Rh:function(t,e,a){"use strict";var i=a("HzJ8"),l=a.n(i),s=a("4YfN"),o=a.n(s);e.a={data:function(){return{loading:!1,billStatus:!1,visibleMenuSelectStatus:!1,checkedCities:["对账单编号","平台名称","客户名称","产品名称","账目周期","消耗金额","折后金额","结算金额","结算模式","折扣","支付状态"],cities:["对账单编号","平台名称","客户名称","产品名称","账目周期","消耗金额","折后金额","结算金额","结算模式","折扣","支付状态"],citiesFilterVal:["billNo","pltName","custmoerName","prdName","accountCycle","consumeAmount","settleDiscountAmount","actualAmout","settleMode","rebate","payStatus"],table_column:[{fixed:!1,prop:"billNo",label:"对账单编号",sortable:!1,visible:!0,minwidth:110},{fixed:!1,prop:"pltName",label:"平台名称",sortable:!1,visible:!0,minwidth:100},{fixed:!1,prop:"custmoerName",label:"客户名称",sortable:!1,visible:!0,minwidth:200},{fixed:!1,prop:"prdName",label:"产品名称",sortable:!1,visible:!0,minwidth:100},{fixed:!1,prop:"accountCycle",label:"账目周期",sortable:!1,visible:!0,minwidth:110},{fixed:!1,prop:"consumeAmount",label:"消耗金额",sortable:!1,visible:!0},{fixed:!1,prop:"settleDiscountAmount",label:"折后金额",sortable:!1,visible:!0}],tabale_column_one:[{fixed:!1,prop:"settleMode",label:"结算模式",sortable:!1,visible:!0,minwidth:100},{fixed:!1,prop:"rebate",label:"折扣",sortable:!1,visible:!0,minwidth:80},{fixed:!1,prop:"payStatus",label:"支付状态",sortable:!1,visible:!0,minwidth:150}],table_column_bill_detail:[{fixed:!1,prop:"date",label:"日期",sortable:!0,visible:!0},{fixed:!1,prop:"customerName",label:"客户名称",sortable:!1,visible:!0},{fixed:!1,prop:"productName",label:"产品名称",sortable:!1,visible:!0},{fixed:!1,prop:"accountName",label:"账号",sortable:!1,visible:!0},{fixed:!1,prop:"platformName",label:"平台名称",sortable:!1,visible:!0},{fixed:!1,prop:"consumeAmount",label:"消耗金额",sortable:!1,visible:!0},{fixed:!1,prop:"settleDiscountAmount",label:"折后金额",sortable:!1,visible:!0},{fixed:!1,prop:"settleStatus",label:"结算状态",sortable:!0,visible:!0,format:function(t,e){switch(t.settleStatus){case"0":return"未结算";case"1":return"已结算";case"2":return"已核算";case"3":return"不结算";case"4":return"已抵扣"}}}],table_column_bill_title:[{fixed:!1,prop:"billNo",label:"结算单号",sortable:!1,visible:!0},{fixed:!1,prop:"date",label:"结算单日期",sortable:!1,visible:!0},{fixed:!1,prop:"customerName",label:"客户名称",sortable:!1,visible:!0},{fixed:!1,prop:"consumeAmount",label:"消耗金额",sortable:!1,visible:!0},{fixed:!1,prop:"settleDiscountAmount",label:"折后金额",sortable:!1,visible:!0}],page:{sizes:[10,20,50,100,200,500],offset:1,limit:10,count:0,currentPage:1},pickerOptions2:{shortcuts:[{text:"本月",onClick:function(t){var e=new Date,a=new Date;a.setDate(1),t.$emit("pick",[a,e])}},{text:"上个月",onClick:function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth(),l=new Date(a,i-1,1),s=new Date(a,i,0).getDate(),o=new Date(a,i-1,s);t.$emit("pick",[l,o])}},{text:"前三个月",onClick:function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth(),l=new Date(a,i-3,1),s=new Date(a,i,0).getDate(),o=new Date(a,i-1,s);t.$emit("pick",[l,o])}}]},menu_nav:["信息流数据管理","客户结算单"],customer_items:{model_value:"",placeHolder:"客户",options:[]},pay_items:{model_value:"",placeHolder:"支付状态"},tableDataBill:[],tableDataBillDetail:[],tableData:[],billNo:"",dateValue:"",params:{type:"1",val:"",date:""},importSearchDataValue:"",isFirstEnter:!1}},activated:function(){this.$route.meta.isBack&&!this.isFirstEnter||this.customer(),this.$route.meta.isBack=!1,this.isFirstEnter=!1},created:function(){this.isFirstEnter=!0},methods:{customer:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpCusGetCustomerList}).then(function(e){if(200==e.status){var a=e.data;t.customer_items.options=a}}).catch(function(t){console.log(t)})},pageInfo:function(){var t=this;if(""==this.dateValue||void 0===this.dateValue&&null==this.dateValue[0])return this.$message({type:"info",message:"请选择日期"}),!1;this.loading=!0;var e={curPage:this.page.offset,limit:this.page.limit,sDateTime:this.params.date,customerId:this.customer_items.model_value,paystatus:this.pay_items.model_value};this.$http({method:"get",url:this.apiUrl.fdpCusSetFilter,params:e}).then(function(e){t.loading=!1,(e.status=200)&&(console.log(e),t.importSearchDataValue=t.billNo="",t.page.count=e.data.totalNums,t.tableData=e.data.list.map(function(e,a){var i=e.settleMode;switch(i){case"1":i="预收抵扣";break;case"2":i="正常结算";break;case"3":i="充值结算"}var l=t.$store.getters.findDingStatus(e.payStatus)?t.$store.getters.findDingStatus(e.payStatus).val:"财务已确认";return o()({},e,{settleMode:i,payStatus:l})}))}).catch(function(e){t.$message({type:"error",message:"查询失败"}),t.loading=!1})},seeCusBill:function(t){var e=this;this.$http({method:"get",url:this.apiUrl.fdpCusDisplay,params:{Id:t}}).then(function(t){if(200==t.status){var a=t.data;e.tableDataBill=[],e.tableDataBill.push(a.csItem),e.tableDataBillDetail=a.listData}}).catch(function(t,e){console.log(e)})},seeBill:function(t){this.seeCusBill(t),this.billStatus=!0},searchBill:function(){var t=this;if(""==this.billNo)return this.$message({type:"info",message:"对账单编号不能为空"}),!1;this.$http({method:"get",url:this.apiUrl.fdpCusSetSearch,params:{billNo:this.billNo}}).then(function(e){(e.status=200)&&(t.importSearchDataValue=t.billNo,t.page.count=e.data.totalNums,t.tableData=e.data.list)}).catch(function(e){t.$message({type:"error",message:"查询失败"})})},submitBill:function(t){var e=this;0==t.row.payStatus&&(this.loading=!0,this.$http({method:"get",url:this.apiUrl.fdpCusSettlementSubmitApproval,params:{id:t.row.id,amount:t.row.actualAmout}}).then(function(t){e.loading=!1,200==t.status&&(console.log(t),1==t.data.status&&(e.$message({type:"info",message:"操作成功"}),e.pageInfo()),2==t.data.status&&e.$message({type:"info",message:"提交失败，请重试！"}))}).catch(function(t){e.loading=!1}))},handleCurrentChange:function(t){this.page.offset=t,this.pageInfo()},handleSizeChange:function(t){this.page.limit=t,this.pageInfo()},checkedChange:function(){var t=this.table_column.concat(this.tabale_column_one),e=!0,a=!1,i=void 0;try{for(var s,o=l()(t);!(e=(s=o.next()).done);e=!0){var n=s.value,r=this.checkedCities.indexOf(n.label);n.visible=r>=0}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}},changeCheckStatus:function(){this.visibleMenuSelectStatus=!this.visibleMenuSelectStatus},exitBill:function(){this.billStatus=!1},deleteBill:function(t){var e=this;this.$confirm("此操作将永久删除该账单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({method:"get",url:e.apiUrl.fdpCusDelete,params:{Id:t}}).then(function(t){if(200==t.status){var a=t.data;1==a.status?(e.$message({type:"success",message:"删除成功"}),e.pageInfo()):e.$message({type:"error",message:a.msg})}else e.$message({type:"error",message:"删除失败!"})}).catch(function(t){e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},bodyEvent:function(){this.visibleMenuSelectStatus=!1,this.billStatus=!1},seeEvent:function(){this.billStatus=!0},dateChange:function(){""!=this.dateValue&&void 0!==this.dateValue&&null!=this.dateValue[0]&&null!=this.dateValue[1]?this.params.date=this.formatDateTime(this.dateValue[0],"y/m/d")+"-"+this.formatDateTime(this.dateValue[1],"y/m/d"):this.params.date=""},importData:function(){if(0==this.tableData.length)return this.$message({type:"info",message:"请查询数据"}),!1;var t=this.cities,e=this.citiesFilterVal,a=this.tableData,i=this.importSearchDataValue?[this.importSearchDataValue,"客户结算单"]:[this.params.date,this.customer_items.model_value,this.pay_items.model_value,"客户结算单"],l=i.join("_");this.handleDownload(t,e,a,l)}}}},XcMe:function(t,e,a){var i=a("Fweb");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("FIqI")("586d5a16",i,!0,{})},pAE3:function(t,e,a){"use strict";function i(t){a("XcMe")}Object.defineProperty(e,"__esModule",{value:!0});var l=a("M8Rh"),s=a("Cnqc"),o=a("vSla"),n=i,r=o(l.a,s.a,!1,n,null,null);e.default=r.exports}});
//# sourceMappingURL=38.72a59dad30db0d8b5ad8.js.map