webpackJsonp([22],{Circ:function(t,e,o){"use strict";var a=o("HzJ8"),r=o.n(a);e.a={data:function(){return{dateValue:"",title:"创建产品信息",menu_nav:["信息流数据管理","产品管理","编辑产品信息"],checks:[],checkList:[],relationList:[],proInfo:{budget:"",customId:"",platformId:"",productName:"",rebateList:[{time:"",value:""}]},productId:"",relationAccountInfo:{},platform_items:{model_value:"",placeHolder:"平台",options:[]},customer_items:{model_value:"",placeHolder:"客户",options:[]}}},created:function(){this.productId=this.$route.query.proId,this.platform(),this.customer(),this.pageInfo()},methods:{platform:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpPlaGetPlatformList}).then(function(e){if(200==e.status){var o=e.data;t.platform_items.options=o}}).catch(function(t){console.log(t)})},customer:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpCusGetCustomerList}).then(function(e){if(200==e.status){var o=e.data;t.customer_items.options=o}}).catch(function(t){console.log(t)})},account:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpAccSearchAccount,params:{offset:1,limit:9999,platformId:this.proInfo.platformId}}).then(function(e){if(200==e.status){var o=e.data;t.checks=[];var a=!0,s=!1,i=void 0;try{for(var n,l=r()(o.items);!(a=(n=l.next()).done);a=!0){var c=n.value;(null==c.productName||c.productName==t.proInfo.productName)&&t.checks.push(c)}}catch(t){s=!0,i=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw i}}t.accountInfo()}}).catch(function(t){console.log(t)})},pageInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpProListproduct,params:{productId:this.productId}}).then(function(e){200==e.status&&(t.proInfo=e.data,t.account())}).catch(function(t){console.log(t)})},accountInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.fdpProSearch_product_account,params:{productId:this.productId,platformId:this.proInfo.platformId}}).then(function(e){if(200==e.status){var o=e.data;t.relationAccountInfo=o,t.checkList=[];var a=!0,s=!1,i=void 0;try{for(var n,l=r()(o.list);!(a=(n=l.next()).done);a=!0){var c=n.value,u=!0,f=!1,p=void 0;try{for(var d,m=r()(t.checks);!(u=(d=m.next()).done);u=!0){var h=d.value;c.accountId==h.id&&t.checkList.push(h.name)}}catch(t){f=!0,p=t}finally{try{!u&&m.return&&m.return()}finally{if(f)throw p}}}}catch(t){s=!0,i=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw i}}}}).catch(function(t){console.log(t)})},onSubmit:function(){var t=this;for(var e in this.proInfo)if("rebateList"==e){for(var o=this.proInfo[e],a=o.length,r=0;r<a;r++)""!=o[r].time&&""!=o[r].value||(o.splice(r,1),r--,a=o.length);0==a&&this.addRow()}this.$http({method:"post",url:this.apiUrl.fdpProModify,data:this.proInfo}).then(function(e){if(console.log(e),200==e.status){var o=e.data;1==o.status?(t.$message({type:"success",message:o.msg}),t.productId=o.id):t.$message({type:"error",message:o.msg})}else t.$message({type:"error",message:"创建失败，请完善信息，并重新提交"})}).catch(function(e){console.log(e),t.$message({type:"error",message:"请完善信息，并重新提交"})})},go_back:function(){this.$router.back()},dateChange:function(t,e){this.proInfo.rebateList[e].time=""!=t&&void 0!==t&&null!=t?this.formatDateTime(new Date(t),"y-m-d"):""},relatAccount:function(){var t=this;this.relationList=[];var e=!0,o=!1,a=void 0;try{for(var s,i=r()(this.checkList);!(e=(s=i.next()).done);e=!0){var n=s.value,l=!0,c=!1,u=void 0;try{for(var f,p=r()(this.checks);!(l=(f=p.next()).done);l=!0){var d=f.value;d.name===n&&this.relationList.push({accountId:d.id,accountName:d.name})}}catch(t){c=!0,u=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw u}}}}catch(t){o=!0,a=t}finally{try{!e&&i.return&&i.return()}finally{if(o)throw a}}this.$http({method:"post",url:this.apiUrl.fdpProUpdate_product_account,data:{list:this.relationList,platformId:this.proInfo.platformId,productId:this.productId,productName:this.proInfo.productName}}).then(function(e){if(console.log(e),200==e.status){var o=e.data;1==o.status?(t.$message({type:"success",message:o.msg}),t.go_back()):t.$message({type:"error",message:o.msg})}else t.$message({type:"error",message:"关联失败，请完善信息，并重新提交"})}).catch(function(e){console.log(e),t.$message({type:"error",message:"请完善信息，并重新提交"})})},addRow:function(){var t=!0,e=!1,o=void 0;try{for(var a,s=r()(this.proInfo.rebateList);!(t=(a=s.next()).done);t=!0){var i=a.value;if(""==i.time||""==i.value)return this.$message({type:"info",message:"请完善返点比例信息再添加新行"}),!1}}catch(t){e=!0,o=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw o}}this.proInfo.rebateList.push({time:"",value:""})}}}},mpxf:function(t,e,o){var a=o("yKjl");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("FIqI")("19b261ea",a,!0,{})},racA:function(t,e,o){"use strict";function a(t){o("mpxf")}Object.defineProperty(e,"__esModule",{value:!0});var r=o("Circ"),s=o("zxNP"),i=o("vSla"),n=a,l=i(r.a,s.a,!1,n,null,null);e.default=l.exports},yKjl:function(t,e,o){e=t.exports=o("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"proManaEdit.vue",sourceRoot:""}])},zxNP:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"page_create customerInfoNew"},[o("div",{staticClass:"menuNav"},[o("p",[o("i",{staticClass:"nav_index"}),t._l(t.menu_nav,function(e,a){return o("span",{key:a},[o("i",{staticClass:"el-icon-arrow-right"}),o("em",[t._v(t._s(e))])])})],2)]),t._v(" "),o("div",{staticClass:"page_d_title"},[o("i"),o("span",[t._v(t._s(t.title))])]),t._v(" "),o("div",{staticClass:"page_d_con"},[o("div",{staticClass:"page_d_con_left"},[o("el-form",{ref:"form",attrs:{model:t.proInfo,"label-width":"125px"}},[o("div",{staticClass:"banner_part_line page_create_set_line"},[t._v("账号信息")]),t._v(" "),o("el-form-item",{attrs:{label:"选择平台："}},[o("el-select",{staticClass:"f_select1",attrs:{filterable:"",placeholder:"请选择",disabled:""},model:{value:t.proInfo.platformId,callback:function(e){t.$set(t.proInfo,"platformId",e)},expression:"proInfo.platformId"}},t._l(t.platform_items.options,function(t,e){return o("el-option",{key:t.platformId,attrs:{label:t.platformName,value:t.platformId}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"客户名称："}},[o("el-select",{staticClass:"f_select1",attrs:{filterable:"",placeholder:"请选择",disabled:""},model:{value:t.proInfo.customId,callback:function(e){t.$set(t.proInfo,"customId",e)},expression:"proInfo.customId"}},t._l(t.customer_items.options,function(t,e){return o("el-option",{key:t.id,attrs:{label:t.customerName,value:t.id}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"产品名称："}},[o("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.proInfo.productName,callback:function(e){t.$set(t.proInfo,"productName",e)},expression:"proInfo.productName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"添加预算："}},[o("el-input",{style:{"margin-right":"10px"},attrs:{placeholder:"请输入预算"},model:{value:t.proInfo.budget,callback:function(e){t.$set(t.proInfo,"budget",e)},expression:"proInfo.budget"}}),t._v("\n                        元\n                    ")],1),t._v(" "),o("el-form-item",{staticStyle:{height:"auto",position:"relative"},attrs:{label:"返点比例："}},[t._l(t.proInfo.rebateList,function(e,a){return o("el-form-item",{key:a},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:function(o){t.dateChange(e.time,a)}},model:{value:e.time,callback:function(o){t.$set(e,"time",o)},expression:"item.time"}}),t._v(" "),o("el-input",{style:{margin:"0 10px"},attrs:{type:"number",placeholder:"请输入返点比例"},model:{value:e.value,callback:function(o){t.$set(e,"value",o)},expression:"item.value"}}),t._v("\n                            %\n                        ")],1)}),t._v(" "),o("div",{staticClass:"addRow"},[o("el-button",{on:{click:function(e){t.addRow()}}},[t._v("添加一行")])],1)],2),t._v(" "),o("el-form-item",{staticClass:"form_button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确认")]),t._v(" "),o("el-button",{on:{click:function(e){t.go_back()}}},[t._v("返回")])],1),t._v(" "),o("div",{staticClass:"banner_part_line page_create_set_line"},[t._v("添加关联账号")]),t._v(" "),o("el-form-item",{staticStyle:{height:"auto",position:"relative"},attrs:{label:"关联账号："}},[o("div",{staticClass:"checkGroupBox"},[o("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.checks,function(t,e){return o("el-checkbox",{key:t.id,attrs:{label:t.name}})}))],1)]),t._v(" "),o("el-form-item",{staticClass:"form_button"},[o("el-button",{attrs:{type:"primary"},on:{click:t.relatAccount}},[t._v("确认")]),t._v(" "),o("el-button",{on:{click:function(e){t.go_back()}}},[t._v("返回")])],1)],1)],1)])])])},r=[],s={render:a,staticRenderFns:r};e.a=s}});
//# sourceMappingURL=22.4959f01cec49a1a3f4ed.js.map