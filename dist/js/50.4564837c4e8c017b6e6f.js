webpackJsonp([50],{Bcbj:function(t,e,a){var i=a("ZzFR");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("FIqI")("3bb77fd9",i,!0,{})},ZzFR:function(t,e,a){e=t.exports=a("UTlt")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"realTimeData.vue",sourceRoot:""}])},bg9z:function(t,e,a){"use strict";var i=a("HzJ8"),s=a.n(i);e.a={data:function(){return{proModelValue:[],fileList:[],loading:!1,multipleStatus:!1,visibleMenuSelectStatus:!1,activationVisible:!1,importTitleStatus:!1,importTitleTxt:"",checkedCities:["日期","产品名称","上游渠道号","产品包渠道代码","预估激活","结算激活","留存率","渠道名称","客户名称"],cities:["日期","产品名称","上游渠道号","康远渠道号","产品包渠道代码","预估激活","结算激活","调账激活","留存率","数据属性","渠道名称","客户名称","客户ID"],citiesFilterVal:["dataTime","productName","productChannelCode","kyChannelName","channelProductCode","expectedAct","settlementAct","adjustmentAct","retention","dataType","channelName","customerName","id"],table_column:[{fixed:!0,prop:"dataTime",label:"日期",sortable:!0,visible:!0},{fixed:!1,prop:"customerName",label:"客户名称",sortable:!1,visible:!0,width:150},{fixed:!1,prop:"id",label:"客户ID",sortable:!1,visible:!1},{fixed:!1,prop:"productName",label:"产品名称",sortable:!1,visible:!0,width:150},{fixed:!1,prop:"productChannelCode",label:"上游渠道号",sortable:!1,visible:!0,width:280},{fixed:!1,prop:"kyChannelName",label:"康远渠道号",sortable:!1,visible:!1,width:200},{fixed:!1,prop:"channelName",label:"渠道名称",sortable:!1,visible:!0,width:150},{fixed:!1,prop:"expectedAct",label:"预估激活",sortable:!1,visible:!0},{fixed:!1,prop:"settlementAct",label:"结算激活",sortable:!1,visible:!0}],table_column_:[{fixed:!1,prop:"retention",label:"留存率",sortable:!1,visible:!0,format:function(t,e){return"总计"!=t.dataTime?t.retention+"%":""}},{fixed:!1,prop:"dataType",label:"数据属性",sortable:!1,visible:!1}],page:{sizes:[100,500,1e3,5e3],offset:1,limit:100,count:0,currentPage:1},menu_nav:["CPA数据管理","实时数据"],tableData:[],dateValue:"",customer_items:{model_value:"",placeHolder:"客户",options:[]},pro_items:{model_value:"",placeHolder:"产品",options:[]},channelPro_items:{model_value:"",placeHolder:"上游渠道号",options:[]},channel_items:{model_value:"",placeHolder:"渠道",options:[]},params:{type:"",val:"",startDate:"",endDate:""},value:"",isSearch:!1,checkAll:!0,idList:[],isFirstEnter:!1}},activated:function(){this.$route.meta.isBack&&!this.isFirstEnter||this.customerSelect(),this.$route.meta.isBack=!1,this.isFirstEnter=!1,this.pageInfo()},created:function(){this.isFirstEnter=!0},methods:{customerSelect:function(){var t=this;this.$http({method:"get",url:this.apiUrl.customerSearch,params:{offset:1,limit:9999,val:""}}).then(function(e){if(200==e.status){var a=e.data;t.customer_items.options=a.items}}).catch(function(t){console.log(t)})},proInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.customerProListLight,params:{customerCode:this.customer_items.model_value}}).then(function(e){if(200==e.status){var a=e.data;t.pro_items.options=a.items,t.proModelValue=[]}}).catch(function(t){console.log(t)})},channelProInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.customerProSearch,params:{offset:1,limit:9999,type:2,code:this.proModelValue.join("|")}}).then(function(e){if(200==e.status){var a=e.data;t.channelPro_items.options=a.items,t.channelPro_items.model_value=""}}).catch(function(t){console.log(t)})},channelInfo:function(){var t=this;this.$http({method:"get",url:this.apiUrl.channelProSearch,params:{offset:1,limit:9999,type:4,code:this.channelPro_items.model_value}}).then(function(e){if(200==e.status){var a=e.data;t.channel_items.options=a.items,t.channel_items.model_value=""}}).catch(function(t){console.log(t)})},select:function(t,e){if(""!=e)switch(this.params.type=t,this.params.val=e,t){case"1":this.proInfo();break;case"2":this.params.val=e.join("|"),e.length<=1?(this.multipleStatus=!1,this.channelProInfo()):this.multipleStatus=!0;break;case"3":this.channelInfo()}},search:function(){this.params.startDate&&this.params.endDate?this.value?(this.isSearch=!0,this.pageInfo()):this.$message({type:"info",message:"请输入上游渠道号"}):this.$message({type:"info",message:"请选择日期"})},sql:function(){this.isSearch=!1,this.pageInfo()},pageInfo:function(){var t=this;this.loading=!0,this.$http({method:"get",url:this.apiUrl.realtimeSearch,params:{curPage:this.page.offset,limit:this.page.limit,type:this.isSearch?"5":this.params.type,searchKey:this.isSearch?this.value:this.params.val,sDataTime:this.params.startDate,eDataTime:this.params.endDate}}).then(function(e){if(t.loading=!1,e.status=200){t.page.count=e.data.totalNums;var a=!0,i=!1,l=void 0;try{for(var n,o=s()(e.data.list);!(a=(n=o.next()).done);a=!0){n.value.validStatus=!1}}catch(t){i=!0,l=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw l}}t.tableData=e.data.list,t.tableData.length>0&&t.tableData.unshift({dataTime:"总计",settlementAct:e.data.settlementActTotal,validStatus:"button"}),t.checkAll=!0,t.idList=[]}}).catch(function(e){t.loading=!1})},handleCurrentChange:function(t){this.page.offset=t,this.pageInfo()},handleSizeChange:function(t){this.page.limit=t,this.pageInfo()},checkedChange:function(){var t=this.checkedCities.indexOf("调账激活");this.activationVisible=t>=0;var e=this.table_column.concat(this.table_column_),a=!0,i=!1,l=void 0;try{for(var n,o=s()(e);!(a=(n=o.next()).done);a=!0){var c=n.value,r=this.checkedCities.indexOf(c.label);c.visible=r>=0}}catch(t){i=!0,l=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw l}}},changeCheckStatus:function(t){t.stopPropagation(),this.visibleMenuSelectStatus=!this.visibleMenuSelectStatus},handleSuccess:function(t,e,a){this.importTitleTxt=t.msg,this.importTitleStatus=!0},uploadError:function(t,e,a){this.$message({type:"error",message:"上传失败，请重试"})},beforeAvatarUpload:function(t){var e=t.name.split("."),a=e.length-1,i="csv"===e[a],s=t.size/1024/1024<2;return i||this.$message({type:"info",message:"上传渠道包只能是 csv 格式"}),s||this.$message({type:"info",message:"上传包大小不能超过 2MB"}),i&&s},bodyEvent:function(){this.visibleMenuSelectStatus=!1},preventDefault:function(t){t.stopPropagation()},changeInput:function(t){return t},exitInput:function(t,e){var a=this;e||this.$message({type:"info",message:"您还没有修改调账激活"}),this.$http({method:"put",url:this.apiUrl.realtimeUpdateAct,params:{id:t,act:e}}).then(function(t){(t.status=200)&&a.$message({type:"success",message:"修改成功"})}).catch(function(t){})},exitImportTitle:function(){this.importTitleStatus=!1,this.pageInfo()},dateChange:function(){this.params.startDate=this.formatDateTime(this.dateValue[0],"y-m-d"),this.params.endDate=this.formatDateTime(this.dateValue[1],"y-m-d")},importData:function(){if(0==this.tableData.length)return this.$message({type:"info",message:"请查询数据"}),!1;var t=this.cities,e=this.citiesFilterVal,a=this.tableData,i=[this.params.startDate,this.params.endDate,this.value,"实时数据"],s=[this.params.startDate,this.params.endDate,this.customer_items.model_value,this.proModelValue.join("|"),this.channelPro_items.model_value,this.channel_items.model_value,"实时数据"],l=(this.isSearch?i:s).join("_");this.handleDownload(t,e,a,l)},deleteBill:function(t){var e=this;this.$confirm("此操作将永久删除当前行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({method:"delete",url:e.apiUrl.realtimeDelete,params:{id:t}}).then(function(t){200==t.status?1==t.data.status?(e.$message({type:"success",message:"删除成功!"}),e.pageInfo()):e.$message({type:"error",message:t.data.msg}):e.$message({type:"error",message:"删除失败!"})}).catch(function(t){e.$message({type:"error",message:"删除失败!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},mulDelete:function(){var t=this;this.idList=[];var e=!0,a=!1,i=void 0;try{for(var l,n=s()(this.tableData);!(e=(l=n.next()).done);e=!0){var o=l.value;o.validStatus&&"button"!=o.validStatus&&this.idList.push(o.id)}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}if(0==this.idList.length)return this.$message({type:"info",message:"请选择需要删除的行"}),!1;this.$confirm("此操作将永久删除所选行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({method:"delete",url:t.apiUrl.realtimeBatch_del,params:{ids:t.idList.join(",")}}).then(function(e){console.log(e);var a=[];e.data&&(a=e.data.list);var i="";a.forEach(function(t,e){i+='<p class="'+(1==t.status?"delSuc":"")+'"><span class="tipId">ID：'+t.id+'</span><span class="tipStatus">状态：'+(1==t.status?"删除成功":"删除失败")+'</span><span class="tipMemo">备注：'+t.msg+"</span></p>"}),t.importTitleTxt=i,t.importTitleStatus=!0}).catch(function(e){t.$message({type:"error",message:"删除失败!"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},checkAllEvent:function(){var t=!0,e=!0,a=!1,i=void 0;try{for(var l,n=s()(this.tableData);!(e=(l=n.next()).done);e=!0){var o=l.value;"button"!=o.validStatus&&(o.validStatus=this.checkAll,t=!1)}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}if(t)return!1;this.checkAll=!this.checkAll}}}},bwn1:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"info_flow_content",on:{click:t.bodyEvent}},[a("div",{staticClass:"menuNav"},[a("p",[a("i",{staticClass:"nav_index"}),t._l(t.menu_nav,function(e,i){return a("span",{key:i},[a("i",{staticClass:"el-icon-arrow-right"}),a("em",[t._v(t._s(e))])])})],2)]),t._v(" "),a("div",{staticClass:"info_ad_search"},[a("div",{staticClass:"info_a_s_content"},[a("div",{staticClass:"dateSelect"},[a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration"},[t._v("选择日期")]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange",align:"right",placeholder:"选择日期范围",format:"yyyy / MM / dd","picker-options":t.$store.state.pickerOptions2},on:{change:t.dateChange},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),t._v(" "),a("el-input",{staticClass:"page_d_select",attrs:{placeholder:"请输入上游渠道号"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.search()}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),a("el-button",{staticClass:"page_d_s_button",staticStyle:{"margin-left":"77px"},on:{click:function(e){t.search()}}},[t._v("搜索\n                            ")])],1),t._v(" "),a("div",{staticClass:"dateBut"},[a("el-upload",{staticClass:"upload-demo",attrs:{action:t.apiUrl.uploadData,"with-credentials":!0,"on-success":t.handleSuccess,beforeUpload:t.beforeAvatarUpload,onError:t.uploadError,"show-file-list":!1,"file-list":t.fileList}},[a("el-button",{attrs:{type:"primary"}},[a("i",{staticClass:"el-icon-plus"}),t._v("导入数据")])],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.importData(e)}}},[a("i",{staticClass:"el-icon-plus"}),t._v("导出数据\n                            ")])],1)]),t._v(" "),a("div",{staticClass:"realTimeCitySearch"},[a("el-select",{staticClass:"con_select unBorderRadius",attrs:{placeholder:t.customer_items.placeHolder,filterable:""},on:{change:function(e){t.select("1",t.customer_items.model_value)}},model:{value:t.customer_items.model_value,callback:function(e){t.$set(t.customer_items,"model_value",e)},expression:"customer_items.model_value"}},t._l(t.customer_items.options,function(t){return a("el-option",{key:t.customerCode,attrs:{label:t.name,value:t.customerCode}})})),t._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{placeholder:t.pro_items.placeHolder,multiple:""},on:{change:function(e){t.select("2",t.proModelValue)}},model:{value:t.proModelValue,callback:function(e){t.proModelValue=e},expression:"proModelValue"}},t._l(t.pro_items.options,function(t){return a("el-option",{key:t.id,attrs:{label:t.productName,value:t.customerProductCode}})})),t._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{disabled:t.multipleStatus,placeholder:t.channelPro_items.placeHolder,filterable:""},on:{change:function(e){t.select("3",t.channelPro_items.model_value)}},model:{value:t.channelPro_items.model_value,callback:function(e){t.$set(t.channelPro_items,"model_value",e)},expression:"channelPro_items.model_value"}},t._l(t.channelPro_items.options,function(t){return a("el-option",{key:t.productPackageCode,attrs:{label:t.productChannelCode,value:t.productPackageCode}})})),t._v(" "),a("el-select",{staticClass:"con_select unBorderRadius",attrs:{disabled:t.multipleStatus,placeholder:t.channel_items.placeHolder},on:{change:function(e){t.select("4",t.channel_items.model_value)}},model:{value:t.channel_items.model_value,callback:function(e){t.$set(t.channel_items,"model_value",e)},expression:"channel_items.model_value"}},t._l(t.channel_items.options,function(t){return a("el-option",{key:t.channelProductCode,attrs:{label:t.channelName,value:t.channelProductCode}})})),t._v(" "),a("el-button",{staticClass:"page_d_s_button",on:{click:t.sql}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"page_d_s_button",staticStyle:{float:"right"},on:{click:t.mulDelete}},[t._v("删除")])],1)])]),t._v(" "),a("div",{staticClass:"info_ad_table"},[a("div",{staticClass:"page_d_title"},[a("i",{staticStyle:{visibility:"hidden"}}),a("span"),t._v(" "),a("div",{staticClass:"tableVisibleMenu"},[a("p",{staticClass:"visibleMenuBut",on:{click:function(e){t.changeCheckStatus(e)}}}),t._v(" "),t.visibleMenuSelectStatus?a("div",{staticClass:"visibleMenuSelect",on:{click:function(e){t.preventDefault(e)}}},[a("el-checkbox-group",{attrs:{min:1},on:{change:t.checkedChange},model:{value:t.checkedCities,callback:function(e){t.checkedCities=e},expression:"checkedCities"}},t._l(t.cities,function(e){return a("el-checkbox",{key:e,attrs:{label:e}},[t._v(t._s(e))])}))],1):t._e()])]),t._v(" "),a("div",{staticClass:"tableDetail"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中",data:t.tableData,border:"",stripe:""}},[t._l(t.table_column,function(e,i){return e.visible?a("el-table-column",{key:e.prop,attrs:{fixed:e.fixed,sortable:e.sortable,prop:e.prop,label:e.label,formatter:e.format,width:e.width,"min-width":"100"}}):t._e()}),t._v(" "),t.activationVisible?a("el-table-column",{attrs:{label:"调账激活","min-width":"150","class-name":"exitInput"},scopedSlots:t._u([{key:"default",fn:function(e){return["总计"!=e.row.dataTime?a("div",[a("el-input",{attrs:{type:"number",placeholder:"",value:e.row.adjustmentAct},on:{change:function(a){e.row.zip=t.changeInput(a)}}}),t._v(" "),a("i",{staticClass:"el-icon-upload2",on:{click:function(a){t.exitInput(e.row.id,e.row.zip)}}})],1):t._e()]}}])}):t._e(),t._v(" "),t._l(t.table_column_,function(e,i){return e.visible?a("el-table-column",{key:e.prop,attrs:{fixed:e.fixed,sortable:e.sortable,prop:e.prop,label:e.label,formatter:e.format,"min-width":"100"}}):t._e()}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100","min-width":"100","class-name":"exitBut"},scopedSlots:t._u([{key:"default",fn:function(e){return["button"==e.row.validStatus?a("span",{staticClass:"r_span",on:{click:t.checkAllEvent}},[t._v(t._s(t.checkAll?"全选":"取消全选"))]):a("el-checkbox",{model:{value:e.row.validStatus,callback:function(a){t.$set(e.row,"validStatus",a)},expression:"scope.row.validStatus"}})]}}])})],2)],1)]),t._v(" "),a("div",{staticClass:"con_pager"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.page.currentPage,"page-sizes":t.page.sizes,"page-size":t.page.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.page.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.page,"currentPage",e)}}})],1)]),t._v(" "),t.importTitleStatus?a("div",{staticClass:"importTitle",on:{click:function(t){t.stopPropagation()}}},[a("div",{staticClass:"importTitle_top"},[a("span",[t._v("提示")]),t._v(" "),a("button",{on:{click:function(e){return e.stopPropagation(),t.exitImportTitle(e)}}},[t._v("×")])]),t._v(" "),a("div",{staticClass:"importTitleTxt",domProps:{innerHTML:t._s(t.importTitleTxt)}})]):t._e()])])},s=[],l={render:i,staticRenderFns:s};e.a=l},gigE:function(t,e,a){"use strict";function i(t){a("Bcbj")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("bg9z"),l=a("bwn1"),n=a("vSla"),o=i,c=n(s.a,l.a,!1,o,null,null);e.default=c.exports}});
//# sourceMappingURL=50.4564837c4e8c017b6e6f.js.map